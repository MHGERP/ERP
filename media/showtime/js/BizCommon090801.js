usingNamespace("Biz.Common")["OpenWindow"]={showbasket:function(A){window.open(A,"basketlist")},ShowPicture1:function(A){window.open(A,"","width=715,height=800,top=60,left=300,resizable=1,scrollbars=1,status=no,toolbar=no,location=no,menu=no")},ShowPicture2:function(A){window.open(A,"","width=1000,height=800,top=60,left=100,resizable=1,scrollbars=1,status=no,toolbar=no,location=no,menu=no")},openMemberPriceInfo:function(A){window.open(A,"","width=410,height=400,top=60,left=300,resizable=1,scrollbars=1,status=no,toolbar=no,location=no,menu=no")}};usingNamespace("Biz.Common")["RecommendProduct"]={Delay:function(A){var B=A;$.ajax({type:"GET",dataType:"html",url:B,cache:false,beforeSend:function(C){},success:function(C){Biz.Common.RecommendProduct.proccessed(C)},complete:function(C,D){},error:function(){}})},proccessed:function(B){if($String.IsNullOrEmpty($String.Trim(B))){return}var A=$(B);$("#recommendProductWrapper").html(A);$("#recommendProductWrapper").hide();$("#recommendProductWrapper").fadeIn("slow")}};usingNamespace("Biz.Common")["MiniCart"]={Refresh:function(B,E,F){if(E=="load"){var D=$(".cartCot").html();if(D!=""){$(F).addClass("over");return}}var C;var A=$Url.BuildCurrentUrl("Ajax/Shopping/MiniCart.aspx");if(E=="delete"){C="action=del&productno="+B}$.ajax({type:"GET",dataType:"html",url:A,cache:false,data:C,beforeSend:function(G){},success:function(G){Biz.Common.MiniCart.proccessed(G,E,F)},complete:function(G,H){},error:function(){}})},proccessed:function(B,A,C){if(Environment.PageName=="Shoppingcart"){if(A=="delete"){window.location.reload();return}else{if(A=="load"){Biz.Common.MiniCart.UpdateMiniCart(B);$(C).addClass("over")}else{if(A=="refresh"){Biz.Common.MiniCart.UpdateMiniCart(B);Biz.Common.MiniCart.UpdatePageHeder(B)}}}}else{if(A=="delete"){Biz.Common.MiniCart.UpdateMiniCart(B);Biz.Common.MiniCart.UpdatePageHeder(B)}else{if(A=="load"){Biz.Common.MiniCart.UpdateMiniCart(B);$(C).addClass("over")}else{if(A=="refresh"){Biz.Common.MiniCart.UpdateMiniCart(B);Biz.Common.MiniCart.UpdatePageHeder(B)}}}}},UpdateMiniCart:function(B){var A=$(B);$(".cartCot").html(A)},UpdatePageHeder:function(B){var A=$("#minicartTotalQty").attr("value");$("#headerCartCount").text(A)},onoff:function(B){var A="."+B;var C=$(A);if(C.length){if($.browser.msie){C.parent().hover(function(){Biz.Common.MiniCart.Refresh("","load",this)},function(){C.parent().removeClass("over")})}else{C.parent().mouseover(function(){Biz.Common.MiniCart.Refresh("","load",this)}).mouseout(function(){$(this).removeClass("over")})}}}};usingNamespace("Biz.Common")["RelatedRecommendProducts"]={Scroll:function(D){var C=parseInt($("#relatedRecommendProductHide").attr("totalItem"));if(C<=5){return}var F=parseInt($("#relatedRecommendProductHide").attr("currentPage"));var B=Math.ceil(C/5);if(D=="next"){if(F>=B){F=1}else{F++}}else{if(F<=1){F=B}else{F--}}var A=(F-1)*5;var E=F*5-1;$("#relatedRecommendProductList").hide();$("#relatedRecommendProductList").fadeOut("slow");$("#relatedRecommendProductList").empty();$("#relatedRecommendProductHide ul").each(function(H){var G=parseInt($(this).attr("index"));if(G>=A&&G<=E){$("#relatedRecommendProductList").append($(this).clone())}});$("#relatedRecommendProductHide").attr("currentPage",F);$("#relatedRecommendProductList").hide();$("#relatedRecommendProductList").fadeIn("slow")}};usingNamespace("Biz.Common")["PageHeader"]={DoSearch:function(B){var A=$.trim($("#txtKeyWord"+B).val());var D=$Resource.BuildContent("SearchValueNull");if(A==null||A==D||$String.IsNullOrEmpty(A)==true){var C=$Resource.BuildContent("MustInputKeyWords");alert(C);return}location.href=$Url.BuildUrl("Product/Search.aspx?keyword="+A,"WWW")},OnInit:function(A){if($("#txtKeyWord"+A)==null){return}$("#txtKeyWord"+A).keydown(function(B){if(B.keyCode==13){Biz.Common.PageHeader.DoSearch(A);return false}})},CurrentTabStore:function(){var B=Environment.PageName;if(B=="TabStore"||B=="Category"||B=="SubCategory"||B=="Product"){var A=Web.Utils.String;var C=A.Trim($(".crumb a:eq(1)").text());if(C==""){C=$(".crumb em").text()}$("#topNav .topNav li").each(function(E){var D=A.Trim($(this).find("span span").text());if(C==D){$(this).addClass("current")}})}}};usingNamespace("Biz.Common")["PromptText"]={systemError:function(){alert($Resource.BuildContent("SystemErrorInfo"))},textBoxFocus:function(A){A[0].style.color="#000000";if($.trim(A.val())==NeweggCN_Web_UI_PromptText_initValue){A.val("")}},textBoxBlur:function(A){if($.trim(A.val())==""){A[0].style.color="#999999";A.val(NeweggCN_Web_UI_PromptText_initValue)}if($.trim(A.val())==NeweggCN_Web_UI_PromptText_initValue){A[0].style.color="#999999"}},textBoxValueOrEmpty:function(C,A){var B=$("#"+C);if(B[0]==null){return}NeweggCN_Web_UI_PromptText_initValue=A;B.focus(function(){NeweggCN.Web.UI.PromptText.textBoxFocus(B)});B.blur(function(){NeweggCN.Web.UI.PromptText.textBoxBlur(B)});NeweggCN.Web.UI.PromptText.textBoxBlur(B)}};usingNamespace("Biz.Common")["TabCtrl"]={tabs:function(A){var B="."+A;var C=$(B);if(C.length){B="."+A;$(B+" .tabHead a").click(function(){var G=$(this).parents(B).get(0).id;var E=$(this).parents(".tabHead").children("*");var F=E.length;E.removeClass("currentBtn");if($(this).parents(".tabHead").children("a").length>0){$(this).addClass("currentBtn")}else{$(this).parent().addClass("currentBtn")}for(var D=1;D<=F;D++){$("#"+G+"_"+D).css("display","none")}$("#"+G+"_"+this.rel).css("display","").show();$("#"+G).data("currSubName",G+"_"+this.rel);return false})}}};usingNamespace("Biz.Common")["HideCtrl"]={hide:function(A,B){if($(B).css("display")!="none"){$(B).hide();$(A).removeClass("show");$(A).addClass("hide")}else{$(B).show();$(A).removeClass("hide");$(A).addClass("show")}},show:function(A,B){if($(B).css("display")!="none"){$(B).hide();$(A).removeClass("hide");$(A).addClass("show")}else{$(B).show();$(A).removeClass("show");$(A).addClass("hide")}}};usingNamespace("Biz.Common")["TableCtrl"]={odd:function(){var A=document.getElementById("specialTable");if(!A){return false}var C=false;var B=A.getElementsByTagName("tr");if(!B){return false}for(i=1;i<B.length;i++){if(C==true){B[i].className="";C=false}else{B[i].className="odd";C=true}}}};usingNamespace("Biz.Common")["OnOffCtrl"]={onoff_2:function(A){var B=$(A);if(B.length){B.mouseover(function(){B.removeClass("over");$(this).addClass("over")})}},onoff:function onoff(B){var A="."+B;var C=$(A);if(C.length){if($.browser.msie){C.parent().hover(function(){$(this).addClass("over")},function(){C.parent().removeClass("over")})}else{C.parent().mouseover(function(){$(this).addClass("over")}).mouseout(function(){$(this).removeClass("over")})}}},onoffDelay:function onoffDelay(B){var D;var A="."+B;var C=$(A);C.parent().mouseover(function(){var E=$(this);D=setTimeout(function(){E.addClass("over")},300)}).mouseout(function(){if(D){clearTimeout(D)}});C.parent().mouseout(function(){$(this).removeClass("over")});C.mouseover(function(){$(this).parent().addClass("over")})}};usingNamespace("Biz.Common")["MoveCtrl"]={iniUnit:function(B,F,A,D){var E=$("#"+F).find(".moveUnit");var C=E.length;if(C>A){Biz.Common.MoveCtrl.addEvent(B,F,A,"next",D)}},addEvent:function(E,H,C,B,G){var A;var D=$("#"+E+" ."+B+"View");var F=D.find("a").length;D.removeClass(B+"Stop");if(F!=0){D=D.find("a")}A=D.find("span").text();D.attr("title",A);D.click(function(){Biz.Common.MoveCtrl.moveUnit(E,H,C,B,G);return false})},moveUnit:function(K,C,B,F,A){if($("#"+K).data("currSubName")!=null){C=$("#"+K).data("currSubName")}var D=$("#"+C).data("nowUnit");if(isNaN(D)){D=0}var J=$("#"+K+" ."+F+"View");var E=J.find("a").length;J.removeClass(F+"Stop");if(E!=0){J=J.find("a")}var I=$("#"+C).find(".moveUnit");var G=I.length;if(F=="next"){for(var H=0;H<A;H++){$(I[D]).hide("fast");if(D==0){$("#"+K+" .prevView").removeClass("prevStop");Biz.Common.MoveCtrl.addEvent(K,C,B,"prev",A)}D=D+1;if(D>(G-B-1)){D=G-B;$("#"+K+" .nextView").addClass("nextStop");J.unbind("click").attr("title","")}}}else{for(var H=0;H<A;H++){D=D-1;$(I[D]).show("fast");if(D+B+A==G){$("#"+K+" .nextView").removeClass("nextStop");Biz.Common.MoveCtrl.addEvent(K,C,B,"next",A)}if(D<=0){D=0;$("#"+K+" .prevView").addClass("prevStop");J.unbind("click").attr("title","")}}}$("#"+C).data("nowUnit",D)}};var popupStatus=0;usingNamespace("Biz.Common")["PopCtrl"]={loadPopup:function(A){objElement="#"+A;if(popupStatus==0){$("#backgroundPopup").css({opacity:"0"});$("#backgroundPopup").show();$(objElement).show();popupStatus=1}},disablePopup:function(){if(popupStatus==1){$("#backgroundPopup").hide();$(objElement).hide();popupStatus=0}},centerPopup:function(C){objElement="#"+C;var A=document.documentElement.clientWidth;var E=document.documentElement.clientHeight;var D=$(objElement).height();var B=$(objElement).width();$(objElement).css({position:"absolute",top:E/2-D/2+document.documentElement.scrollTop,left:A/2-B/2})}};usingNamespace("Biz.Common")["ShowPicture"]={openDialog:function(A,B){window.open(A+"?sysno="+B,"","width=715,height=800,top=60,left=300,resizable=1,scrollbars=1,status=no,toolbar=no,location=no,menu=no")}};usingNamespace("Biz.Common")["Poll"]={clickPoll:function(B,E,D){var A=$("input[@name=vote4NewYear][@checked]").val();if(typeof(A)=="undefined"){A=0}var C=B+"?PollSysno="+E+"&PollType="+D;if(D=="1"){C+="&PollItemSysno="+A}window.open(C,"","")}};usingNamespace("Biz.Common")["BrowseHistory"]={ClearHistory:function(A){document.cookie="BrowsedProductSysNoList =;expires=Fri, 25-Dec-1900 23:59:59 GMT;path=/";document.getElementById(A).style.display="none"}};usingNamespace("Biz.Common")["Validation"]={refreshValidator:function(B,A){$(B).attr("src",$(B).attr("src")+"&r="+Math.random());$(A).focus()},isEmail:function(A){var B=/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/;return B.test(A)},isLowEmail:function(B){var A,C;A=B.indexOf("@");C=B.indexOf(".");if(A<=0){return false}if(C<0||C==(B.length-1)){return false}return true},clearNoNum:function(A,B){A=window.event||A;if(A.keyCode==37|A.keyCode==39){return}B.value=B.value.replace(/[^\d.]/g,"");B.value=B.value.replace(/^\./g,"");B.value=B.value.replace(/\.{2,}/g,".");B.value=B.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".")},checkNum:function(A){A.value=A.value.replace(/\.$/g,"")},isInteger:function(A){var B=new RegExp(/^\d+$/);return B.test(A)},isValidateReg:function(B){var A=/^([A-Za-z0-9\s\-\_\~\!\@\#\$\%\^\&\*\(\)\|\<\>\?\:\;\"\'\.\[\]\{\}\,\+\`\/\\\=]){6,16}$/;if(A.test(B)){return true}return false},isDate:function(H){var C=/^\d{4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/;if(!C.test(H)){return false}else{var F=H.split(RegExp.$1);var G=parseInt(F[2],10);var D=parseInt(F[0],10);var E=parseInt(F[1],10);if(E>12||E<1){return false}var B={"1":31,"3":31,"4":30,"5":31,"6":30,"7":31,"8":31,"9":30,"10":31,"11":30,"12":31};if(B[parseInt(F[1])]!=null){if(G<=B[parseInt(F[1])]&&G!=0){return true}}if(E-2==0){var A=(D%4==0&&(D%100!=0||D%400==0));if(((A&&G<=29)||(!A&&G<=28))&&G!=0){return true}}}return false},isZip:function(B){var A=/^[0-9]{6}$/;return A.test(B)},checkSpecialChar:function(B){var A=/([~!@#$%^&*\/\\,.\(\)]){6,16}$/;return A.test(B)},isTel:function(B){var A=/^\d{3,4}-\d{7,8}(-\d{3,4})?$/;if(!A.exec(B)){return false}return true},isMobile:function(B){var A=/^1\d{10}$/;return A.test(B)},getLength:function(A){return A.replace(/[^\x00-\xff]/g,"**").length},MaxLength:function(F,E){var A=F.value.replace(/[^\x00-\xff]/g,"**").length;var D=F.value;var C="";if(A>E){for(var B=0;B<E;B++){if(C.replace(/[^\x00-\xff]/g,"**").length<E){C=D.substr(0,B+1)}else{break}}if(C.replace(/[^\x00-\xff]/g,"**").length>E){C=C.substr(0,C.length-1);F.value=C}else{F.value=C}}}};usingNamespace("Biz.Common")["ValidateHelper"]={normalMessage:function(A,E){var B=$(A.parent().find("em")[0]);var D=B.find("span")[0];if(D!=null){var C=$Resource.BuildContent(E);B.empty().append(C);B.css("margin-top","2px")}},normalMessageForShippingAddress:function(A,D){var B=$(A.parent().find("em")[0]);if(B!=null){var C=$Resource.BuildContent(D);B.empty().append(C)}},normalMessageForCheckOut:function(A,E){var B=$(A.parent().find("em")[0]);var D=B.find("span")[0];if(D!=null){var C=$Resource.BuildContent(E);B.empty().append(C);B.css("margin-top","8px")}},warningMessageForPersonalInfo:function(A,F){if(A[0]==null){return false}var D=$(A.parent().find("em")[0]);var E=$Resource.BuildContent(F);var B=Biz.Common.Validation.getLength(E)*6;var C="<span style='background:transparent url("+$Resource.BuildImage("icon/iconA.gif")+") no-repeat scroll 10px -1938px;color:#FF4C31;float:left;width:"+B+"px;height:23px;line-height:23px;padding:0 10px 0 35px;margin-top:0px'>"+E+"</span>";D.empty().append(C);D.css("margin-top","0px")},warningMessageForDay:function(A,E){if(A[0]==null){return false}var C=$(A.parent().find("em")[0]);var D=$Resource.BuildContent(E);var B="<span style='background:transparent url("+$Resource.BuildImage("icon/iconA.gif")+") no-repeat scroll 10px -1938px;color:#FF4C31;float:left;width:270px;height:23px;line-height:23px;padding:0 10px 0 35px;margin-top:0px'>"+D+"</span>";C.empty().append(B);C.css("margin-top","0px")},warningMessage:function(A,E){if(A[0]==null){return false}var C=$(A.parent().find("em")[0]);var D=$Resource.BuildContent(E);var B="<span style='background:transparent url("+$Resource.BuildImage("icon/iconA.gif")+") no-repeat scroll 12px -1938px;color:#FF4C31;float:left;height:23px;line-height:23px;padding:0 10px 0 35px;font-weight:lighter;width:120px'>"+D+"</span>";C.empty().append(B);C.css("margin-top","1px")},areaWarningMessage:function(A,E){var D=$(A.parent().find("em")[0]);D.empty();D.hide();var B=$(A.parent().find("#region")[0]);var C=$(A.parent().find("#city")[0]);if(B.val()=="-1"){Biz.Common.ValidateHelper.areaShowWarningMessage(D,B,"AccountCenter_ModifyShippingAddress_ProvinceError")}else{if(C.val()=="-1"){Biz.Common.ValidateHelper.areaShowWarningMessage(D,C,"AccountCenter_ModifyShippingAddress_CityError")}else{if(A.val()=="-1"){Biz.Common.ValidateHelper.areaShowWarningMessage(D,A,E)}}}},areaShowWarningMessage:function(C,A,E){if(A.val()=="-1"){var D=$Resource.BuildContent(E);var B="<span style='background:transparent url("+$Resource.BuildImage("icon/iconA.gif")+") no-repeat scroll 12px -1938px;color:#FF4C31;float:left;width:60px;height:23px;line-height:23px;padding:0 10px 0 35px;margin-top:0px;font-weight:lighter'>"+D+"</span>";C.empty().append(B);C.css("margin-top","0px");C.show()}else{C.empty();C.hide()}},warningMessageForShippingAddress:function(A,E){Biz.Common.ValidateHelper.clearMessage(A);if($String.IsNullOrEmpty($.trim(A.val()))){var C=$(A.parent().find("em")[0]);var D=$Resource.BuildContent(E);var B="<span style='background:transparent url("+$Resource.BuildImage("icon/iconA.gif")+") no-repeat scroll 12px -1938px;color:#FF4C31;float:left;height:23px;line-height:23px;padding:0 10px 0 35px;'>"+D+"</span>";C.empty().append(B);C.css("margin-top","1px")}},warningMessageInclueReplace:function(B,F,A){var D=$(B.parent().find("em")[0]);var E=$Resource.BuildContent(F);E=E.replace("{0}",A);var C="<span style='background:transparent url("+$Resource.BuildImage("icon/iconA.gif")+") no-repeat scroll 12px -1938px;color:#FF4C31;float:left;height:23px;line-height:23px;padding:0 10px 0 35px;'>"+E+"</span>";D.empty().append(C);D.css("margin-top","1px")},clearMessage:function(A){var B=$(A.parent().find("em")[0]);B.empty()},clearMessageForShippingAddress:function(A,B){var C=$(A.parent().find("em")[0]);C.empty();Biz.Common.ValidateHelper.normalMessageForShippingAddress($(A),B)},validateStringValue:function(D,B,C){var A=$(D);Biz.Common.ValidateHelper.clearMessage(D);if($String.IsNullOrEmpty($.trim(A.val()))){Biz.Common.ValidateHelper.warningMessage(A,C)}else{Biz.Common.ValidateHelper.normalMessage(A,B)}},validateStringValueForShippingAddress:function(D,B,C){var A=$(D);Biz.Common.ValidateHelper.clearMessage(D);if($String.IsNullOrEmpty($.trim(A.val()))){Biz.Common.ValidateHelper.warningMessageForPersonalInfo(A,C)}else{if($.trim(A.val()).length>20&&(B=="AccountCenter_ModifyShippingAddress_ReceiveNameDesc"||B=="AccountCenter_ModifyShippingAddress_ReceiveContactDesc")){Biz.Common.ValidateHelper.warningMessageForPersonalInfo(A,"AccountCenter_ModifyShippingAddress_InfoMaxLength")}else{Biz.Common.ValidateHelper.normalMessageForShippingAddress(A,B)}}},validateStringValueForCellPhone:function(D,B,C,E){var A=$(D);Biz.Common.ValidateHelper.clearMessageForShippingAddress(D,B);if(E=="yes"){Biz.Common.ValidateHelper.warningMessageForPersonalInfo(A,C);return}if($.trim(A.val())!=""){if(!Biz.Common.Validation.isMobile($.trim(A.val()))){Biz.Common.ValidateHelper.warningMessageForPersonalInfo(A,C)}}else{Biz.Common.ValidateHelper.normalMessage(A,B)}},validateStringValueForZip:function(C,B){var A=$(C);Biz.Common.ValidateHelper.clearMessageForShippingAddress(C,B);if(!$String.IsNullOrEmpty($.trim(A.val()))){if(!Biz.Common.Validation.isZip(A.val())){Biz.Common.ValidateHelper.warningMessageForPersonalInfo(A,B)}}else{Biz.Common.ValidateHelper.warningMessageForPersonalInfo(A,"AccountCenter_PersonalInfo_ZipEmpty")}},validationSystemAddressArea:function(E,B){var A=$(E);var D=parseInt(A.val());if(D<=0){Biz.Common.ValidateHelper.warningMessage(A,B)}else{var C=$(A.parent().find("em")[0]);var F=C.find("strong span")[0];if(F!=null){C.empty().append("<strong>*</strong>");C.css("margin-top","2px")}else{F=C.find("span")[0];if(F!=null){C.empty().append("*");C.css("margin-top","8px")}}}}};usingNamespace("Biz.Common")["Loading"]={showForRemoveElement:function(B){if(B[0]!=null){var A=$Resource.BuildContent("PopupInfo");B.after('<p id="divLoading" class="process" style="width:150px" ><span>'+A+"</span></p>");B.hide()}},removeLoadingForShowElement:function(A){if(A[0]!=null){var B=A.parent().find("#divLoading");if(B[0]!=null){B.remove()}A.show()}},show:function(C){if(C[0]!=null){var B=$Resource.BuildContent("PopupInfo");var G=C.offset().left;var F=C.offset().top;var D=C.width();var A=C.height();G+=D+20;F+=A/2-24;var E=$('<p id="divLoading" class="process" style="position: absolute;width:150px;height:14px"><span>'+B+"</span></p>");E.css("zindex",100);E.css("left",G.toString()+"px");E.css("top",F.toString()+"px");C.append(E)}},showAreaCenter:function(C){if(C[0]!=null){var G=C.offset().left;var F=C.offset().top;var B=$Resource.BuildContent("PopupInfo");var D=C.width();var A=C.height();G+=D/2-75;F+=A/2-20;var E=$('<p id="divLoading" class="process" style="position: absolute;width:150px"><span>'+B+"</span></p>");E.css("zindex",100);E.css("left",G.toString()+"px");E.css("top",F.toString()+"px");C.append(E)}},showAreaCenterForCheckOut:function(C){if(C[0]!=null){var G=C.offset().left;var F=C.offset().top;var B=$Resource.BuildContent("PopupInfo");var D=C.width();var A=C.height();G+=D/2-75;F+=A/2-28;var E=$('<p id="divLoading" class="process" style="position: absolute;width:150px"><span>'+B+"</span></p>");E.css("zindex",100);E.css("left",G.toString()+"px");E.css("top",F.toString()+"px");C.append(E)}},removeLoading:function(A){if(A[0]!=null){var B=A.find("#divLoading");if(B[0]!=null){B.remove()}}},showLoadingForPersonalInfo:function(B){if(B[0]!=null){var A=$Resource.BuildContent("PopupInfo");var C=$('<p id="divLoading" style="background:#FFFEE2 none repeat scroll 0 0;margin:0px auto 0 310px;border:1px solid #FFB903;padding:8px 12px;list-style-image:none;list-style-position:outside;list-style-type:none;width:150px;height:4px;" ><span style="text-align:center; margin-top:-6px;padding-left:23px;color:#FF6600;background:transparent url('+$Resource.BuildImage("icon/iconE.gif")+') no-repeat scroll center left;">'+A+"</span></p>");B.before(C);B.hide()}}};
